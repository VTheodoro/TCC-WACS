<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - WACS</title>
    <link rel="stylesheet" href="../public/css/styles.css">
    <link rel="stylesheet" href="../public/css/core.css">
    <link rel="stylesheet" href="../public/css/theme-switch.css">
    <link rel="stylesheet" href="../public/css/navbar-modern.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="../public/images/logo-light.png" type="image/png">
    <style>
        /* Estilos da navbar compacta */
        #main-nav {
            min-height: 45px;
        }
        
        .navbar-content {
            padding: 0.35rem 0;
        }
        
        .logo img {
            width: 28px;
            height: auto;
        }
        
        .logo {
            margin-right: 0.5rem;
        }
        
        .logo-text {
            font-size: 1.1rem;
        }
        
        .nav-menu {
            margin-left: 0;
        }
        
        .nav-links {
            gap: 0.25rem;
        }
        
        .nav-links li {
            margin: 0 0.2rem;
        }
        
        .nav-links li:first-child {
            margin-left: 0;
        }
        
        .nav-links li a {
            padding: 0.2rem 0.4rem;
            height: 1.8rem;
            font-size: 0.85rem;
        }
        
        .nav-actions {
            gap: 0.35rem;
        }
        
        .theme-toggle {
            transform: scale(0.8);
        }
        
        .logout-btn {
            padding: 0.2rem 0.65rem;
            font-size: 0.8rem;
        }
        
        .menu-toggle {
            width: 20px;
            height: 14px;
        }
        
        .menu-toggle span {
            height: 1.5px;
        }

        /* Ajuste para o espa√ßo do dashboard */
        .dashboard-container {
            padding-top: 45px;
            min-height: calc(100vh - 45px);
            background: var(--background-color, #fff);
        }
        
        body.dark-theme .dashboard-container {
            background: var(--dark-background, #121212);
        }
        
        .dashboard-header {
            background: var(--accent-color, #e0eaff);
            padding: 2rem 0;
        }
        
        body.dark-theme .dashboard-header {
            background: var(--dark-accent, #1E293B);
        }
        
        .dashboard-header h1 {
            color: var(--primary-color, #0055b3);
            margin-bottom: 0.5rem;
            font-size: 1.75rem;
        }
        
        body.dark-theme .dashboard-header h1 {
            color: var(--dark-primary, #4A90E2);
        }
        
        .dashboard-header p {
            color: var(--text-light, #4b5563);
        }
        
        body.dark-theme .dashboard-header p {
            color: var(--dark-text-light, #94a3b8);
        }
        
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .stat-card {
            background: var(--background-color, #fff);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            transition: transform 0.3s ease;
        }
        
        body.dark-theme .stat-card {
            background: var(--dark-card, #1e1e2d);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: var(--accent-color, #e0eaff);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            color: var(--primary-color, #0055b3);
            font-size: 1.5rem;
        }
        
        body.dark-theme .stat-icon {
            background: var(--dark-accent, #1E293B);
            color: var(--dark-primary, #4A90E2);
        }
        
        .stat-content h3 {
            font-size: 0.9rem;
            color: var(--text-light, #4b5563);
            margin-bottom: 0.25rem;
            font-weight: 500;
        }
        
        body.dark-theme .stat-content h3 {
            color: var(--dark-text-light, #94a3b8);
        }
        
        .stat-content p {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-color, #1f2937);
            margin: 0;
        }
        
        body.dark-theme .stat-content p {
            color: var(--dark-text, #e2e8f0);
        }
        
        .dashboard-content {
            padding: 2rem 0;
        }
        
        .dashboard-section {
            margin-bottom: 3rem;
        }
        
        .dashboard-section h2 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: var(--text-color, #1f2937);
        }
        
        body.dark-theme .dashboard-section h2 {
            color: var(--dark-text, #e2e8f0);
        }
        
        .map-container {
            height: 400px;
            background: #f5f5f5;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light, #4b5563);
            font-size: 1.1rem;
        }
        
        body.dark-theme .map-container {
            background: var(--dark-card, #1e1e2d);
            color: var(--dark-text-light, #94a3b8);
        }
        
        .locations-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .location-card {
            background: var(--background-color, #fff);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        
        body.dark-theme .location-card {
            background: var(--dark-card, #1e1e2d);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .location-card:hover {
            transform: translateY(-5px);
        }
        
        .location-image {
            height: 160px;
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            overflow: hidden;
        }
        
        .location-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .location-card:hover .location-image img {
            transform: scale(1.05);
        }
        
        body.dark-theme .location-image {
            background: #2d3748;
            color: #718096;
        }
        
        .location-details {
            padding: 1.5rem;
        }
        
        .location-details h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--text-color, #1f2937);
        }
        
        body.dark-theme .location-details h3 {
            color: var(--dark-text, #e2e8f0);
        }
        
        .location-details p {
            color: var(--text-light, #4b5563);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        
        body.dark-theme .location-details p {
            color: var(--dark-text-light, #94a3b8);
        }
        
        .location-rating {
            display: flex;
            align-items: center;
            margin-top: 0.5rem;
        }
        
        .location-rating i {
            color: #fbbf24;
            font-size: 0.9rem;
            margin-right: 0.25rem;
        }
        
        .location-rating span {
            margin-left: 0.5rem;
            color: var(--text-light, #4b5563);
            font-size: 0.9rem;
        }
        
        body.dark-theme .location-rating span {
            color: var(--dark-text-light, #94a3b8);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .user-avatar {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: var(--accent-color, #e0eaff);
            color: var(--primary-color, #0055b3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-right: 1rem;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-decoration: none;
        }
        
        .user-avatar:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        body.dark-theme .user-avatar {
            background: var(--dark-accent, #1E293B);
            color: var(--dark-primary, #4A90E2);
        }
        
        body.dark-theme .user-avatar:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .user-details h2 {
            margin-bottom: 0.25rem;
        }
        
        .user-details p {
            color: var(--text-light, #4b5563);
            margin: 0;
            margin-bottom: 0.5rem;
        }
        
        body.dark-theme .user-details p {
            color: var(--dark-text-light, #94a3b8);
        }
        
        .profile-link {
            display: inline-flex;
            align-items: center;
            color: var(--primary-color, #0055b3);
            font-size: 0.875rem;
            text-decoration: none;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }
        
        .profile-link i {
            margin-right: 0.25rem;
        }
        
        .profile-link:hover {
            background-color: var(--accent-color, #e0eaff);
            text-decoration: none;
        }
        
        body.dark-theme .profile-link {
            color: var(--dark-primary, #4A90E2);
        }
        
        body.dark-theme .profile-link:hover {
            background-color: var(--dark-accent, #1E293B);
        }
        
        .logout-btn {
            background: transparent;
            color: var(--primary-color, #0055b3);
            border: 1px solid var(--primary-color, #0055b3);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: auto;
        }
        
        body.dark-theme .logout-btn {
            color: var(--dark-primary, #4A90E2);
            border-color: var(--dark-primary, #4A90E2);
        }
        
        .logout-btn:hover {
            background: var(--primary-color, #0055b3);
            color: white;
        }
        
        body.dark-theme .logout-btn:hover {
            background: var(--dark-primary, #4A90E2);
            color: white;
        }
        
        .add-location-btn {
            display: inline-flex;
            align-items: center;
            background: var(--primary-color, #0055b3);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            margin-top: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        
        body.dark-theme .add-location-btn {
            background: var(--dark-primary, #4A90E2);
        }
        
        .add-location-btn i {
            margin-right: 0.5rem;
        }
        
        .add-location-btn:hover {
            background: var(--primary-hover, #0066d6);
            transform: translateY(-2px);
        }

        /* Estilos para o menu mobile */
        .mobile-menu {
            padding: 0.5rem;
            margin-top: 0.2rem;
        }
        
        .nav-links-mobile {
            margin: 0 0 0.5rem 0;
        }
        
        .nav-links-mobile li {
            margin-bottom: 0.25rem;
        }
        
        .nav-links-mobile a {
            padding: 0.25rem 0.4rem;
            font-size: 0.85rem;
        }
        
        .download-btn-mobile {
            padding: 0.35rem;
            font-size: 0.8rem;
        }
        
        /* Media queries para telas pequenas */
        @media (max-width: 400px) {
            .logo-text {
                display: none;
            }
            
            .nav-links li a {
                padding: 0.2rem 0.3rem;
            }
        }

        /* Centraliza√ß√£o da navbar */
        #main-nav .container {
            display: flex;
            justify-content: center;
        }
        
        .navbar-content {
            width: 100%;
            max-width: 900px;
            justify-content: space-between;
        }
        
        @media (max-width: 960px) {
            .navbar-content {
                max-width: 100%;
                padding-left: 1rem;
                padding-right: 1rem;
            }
        }

        /* Estilos para o modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(3px);
        }
        
        .modal-content {
            background-color: var(--background-color, #fff);
            margin: 5% auto;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
            width: 90%;
            max-width: 600px;
            position: relative;
            animation: modalFadeIn 0.3s ease;
        }
        
        body.dark-theme .modal-content {
            background-color: var(--dark-card, #1e1e2d);
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
        }
        
        @keyframes modalFadeIn {
            from {opacity: 0; transform: translateY(-20px);}
            to {opacity: 1; transform: translateY(0);}
        }
        
        .close-modal {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            color: var(--text-light, #4b5563);
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        body.dark-theme .close-modal {
            color: var(--dark-text-light, #94a3b8);
        }
        
        .close-modal:hover {
            color: var(--primary-color, #0055b3);
        }
        
        body.dark-theme .close-modal:hover {
            color: var(--dark-primary, #4A90E2);
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-color, #1f2937);
        }
        
        body.dark-theme .form-group label {
            color: var(--dark-text, #e2e8f0);
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color, #d1d5db);
            border-radius: 8px;
            background: var(--input-bg, #f9fafb);
            color: var(--text-color, #1f2937);
            font-family: 'Inter', sans-serif;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        body.dark-theme .form-group input,
        body.dark-theme .form-group textarea {
            border-color: var(--dark-border, #2d3748);
            background: var(--dark-input-bg, #1a1a2e);
            color: var(--dark-text, #e2e8f0);
        }
        
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color, #0055b3);
            box-shadow: 0 0 0 3px rgba(0, 85, 179, 0.1);
        }
        
        body.dark-theme .form-group input:focus,
        body.dark-theme .form-group textarea:focus {
            border-color: var(--dark-primary, #4A90E2);
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.2);
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .submit-btn {
            background: var(--primary-color, #0055b3);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            width: 100%;
        }
        
        body.dark-theme .submit-btn {
            background: var(--dark-primary, #4A90E2);
        }
        
        .submit-btn:hover {
            background: var(--primary-hover, #0066d6);
            transform: translateY(-2px);
        }
        
        /* Mensagens de feedback */
        .no-locations, .load-error {
            padding: 2rem;
            text-align: center;
            background: var(--accent-color, #e0eaff);
            border-radius: 12px;
            color: var(--text-color, #1f2937);
            width: 100%;
            margin-bottom: 1.5rem;
        }
        
        body.dark-theme .no-locations, 
        body.dark-theme .load-error {
            background: var(--dark-accent, #1E293B);
            color: var(--dark-text, #e2e8f0);
        }
        
        .load-error {
            background: #fee2e2;
            color: #991b1b;
        }
        
        body.dark-theme .load-error {
            background: #7f1d1d;
            color: #fecaca;
        }
    </style>
</head>
<body>
    <!-- Navigation (Adaptado do Site Base) -->
    <nav class="navbar" id="main-nav">
        <div class="container">
            <div class="navbar-content">
                <!-- Logo com nome -->
                <a href="../index.html" class="logo">
                    <img src="../public/images/logo.png" alt="WACS Logo" class="logo-dark">
                    <img src="../public/images/logo-light.png" alt="WACS Logo" class="logo-light">
                    <span class="logo-text">WACS</span>
                </a>

                <!-- Desktop Menu -->
                <div class="nav-menu">
                    <ul class="nav-links">
                        <li><a href="../index.html">Home</a></li>
                        <li><a href="dashboard.html" class="active">Dashboard</a></li>
                        <li><a href="profile.html">Perfil</a></li>
                    </ul>
                </div>

                <!-- Actions -->
                <div class="nav-actions">
                    <div class="theme-toggle">
                        <label class="switch">
                            <span class="sun"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g fill="#ffd43b"><circle r="5" cy="12" cx="12"></circle><path d="m21 13h-1a1 1 0 0 1 0-2h1a1 1 0 0 1 0 2zm-17 0h-1a1 1 0 0 1 0-2h1a1 1 0 0 1 0 2zm13.66-5.66a1 1 0 0 1 -.66-.29 1 1 0 0 1 0-1.41l.71-.71a1 1 0 1 1 1.41 1.41l-.71.71a1 1 0 0 1 -.75.29zm-12.02 12.02a1 1 0 0 1 -.71-.29 1 1 0 0 1 0-1.41l.71-.66a1 1 0 0 1 1.41 1.41l-.71.71a1 1 0 0 1 -.7.24zm6.36-14.36a1 1 0 0 1 -1-1v-1a1 1 0 0 1 2 0v1a1 1 0 0 1 -1 1zm0 17a1 1 0 0 1 -1-1v-1a1 1 0 0 1 2 0v1a1 1 0 0 1 -1 1zm-5.66-14.66a1 1 0 0 1 -.7-.29l-.71-.71a1 1 0 0 1 1.41-1.41l.71.71a1 1 0 0 1 0 1.41 1 1 0 0 1 -.71.29zm12.02 12.02a1 1 0 0 1 -.7-.29l-.66-.71a1 1 0 0 1 1.36-1.36l.71.71a1 1 0 0 1 0 1.41 1 1 0 0 1 -.71.24z"></path></g></svg></span>
                            <span class="moon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="m223.5 32c-123.5 0-223.5 100.3-223.5 224s100 224 223.5 224c60.6 0 115.5-24.2 155.8-63.4 5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6-96.9 0-175.5-78.8-175.5-176 0-65.8 36-123.1 89.3-153.3 6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"></path></svg></span>   
                            <input type="checkbox" class="input" id="theme-switch" aria-label="Toggle theme">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <button id="logoutBtn" class="logout-btn">Sair</button>
                </div>

                <!-- Mobile Menu Button -->
                <button class="menu-toggle" aria-label="Toggle menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>

            <!-- Mobile Menu Panel -->
            <div class="mobile-menu">
                <ul class="nav-links-mobile">
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="dashboard.html" class="active">Dashboard</a></li>
                    <li><a href="profile.html">Perfil</a></li>
                </ul>
                <button id="logoutBtnMobile" class="download-btn-mobile">Sair</button>
            </div>
        </div>
    </nav>

    <div class="dashboard-container">
        <div class="dashboard-header">
            <div class="container">
                <div class="user-info">
                    <a href="profile.html" class="user-avatar" id="userAvatar" title="Editar perfil">
                        <i class="fas fa-user"></i>
                    </a>
                    <div class="user-details">
                        <h2 id="userName">Carregando...</h2>
                        <p id="userEmail">Carregando...</p>
                        <a href="profile.html" class="profile-link">
                            <i class="fas fa-edit"></i> Editar perfil
                        </a>
                    </div>
                </div>
                
                <div class="dashboard-stats">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Locais Acess√≠veis</h3>
                            <p>125</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Colaboradores</h3>
                            <p>43</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Suas Contribui√ß√µes</h3>
                            <p>0</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="dashboard-content">
            <div class="container">
                <div class="dashboard-section">
                    <h2>Mapa de Locais Acess√≠veis</h2>
                    <div class="map-container">
                        <p>O mapa ser√° carregado aqui</p>
                    </div>
                </div>
                
                <div class="dashboard-section">
                    <h2>Locais Recentes</h2>
                    <div class="locations-list">
                        <div class="location-card">
                            <div class="location-image">
                                <i class="fas fa-image"></i> Imagem do Local
                            </div>
                            <div class="location-details">
                                <h3>Shopping Center Registro</h3>
                                <p>Av. Clara Gianotti de Souza, 1500 - Registro, SP</p>
                                <p>Rampa de acesso, elevadores, banheiros adaptados</p>
                                <div class="location-rating">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                    <span>4.5 (15 avalia√ß√µes)</span>
                                </div>
                            </div>
                        </div>
                        <div class="location-card">
                            <div class="location-image">
                                <i class="fas fa-image"></i> Imagem do Local
                            </div>
                            <div class="location-details">
                                <h3>Parque Municipal</h3>
                                <p>Rua dos Expedicion√°rios, 340 - Registro, SP</p>
                                <p>Caminhos acess√≠veis, √°rea de descanso, banheiros adaptados</p>
                                <div class="location-rating">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="far fa-star"></i>
                                    <span>4.0 (8 avalia√ß√µes)</span>
                                </div>
                            </div>
                        </div>
                        <div class="location-card">
                            <div class="location-image">
                                <i class="fas fa-image"></i> Imagem do Local
                            </div>
                            <div class="location-details">
                                <h3>Terminal Rodovi√°rio</h3>
                                <p>Av. Prefeito Jonas Banks Leite, 300 - Registro, SP</p>
                                <p>Elevadores, piso t√°til, rampas de acesso</p>
                                <div class="location-rating">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="far fa-star"></i>
                                    <i class="far fa-star"></i>
                                    <span>3.2 (10 avalia√ß√µes)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <a href="#" class="add-location-btn" id="openAddLocationModal">
                        <i class="fas fa-plus"></i> Adicionar Local Acess√≠vel
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para adicionar local acess√≠vel -->
    <div id="addLocationModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Adicionar Local Acess√≠vel</h2>
            <form id="addLocationForm">
                <div class="form-group">
                    <label for="locationName">Nome do Local</label>
                    <input type="text" id="locationName" required>
                </div>
                <div class="form-group">
                    <label for="locationAddress">Endere√ßo Completo</label>
                    <input type="text" id="locationAddress" required>
                </div>
                <div class="form-group">
                    <label for="locationFeatures">Recursos de Acessibilidade</label>
                    <textarea id="locationFeatures" placeholder="Descreva os recursos de acessibilidade (ex: rampa de acesso, elevadores, etc)" required></textarea>
                </div>
                <div class="form-group">
                    <label for="locationImage">URL da Imagem (opcional)</label>
                    <input type="url" id="locationImage" placeholder="https://exemplo.com/imagem.jpg">
                </div>
                <button type="submit" class="submit-btn">Salvar Local</button>
            </form>
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <script src="../public/js/theme.js"></script>
    <script src="../public/js/navbar-modern.js"></script>
    <script src="../public/js/env-config.js"></script>
    <script src="../public/js/firebase-dashboard.js"></script>
    
    <!-- Script para o modal e funcionalidade de adicionar locais -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos do DOM
            const openModalBtn = document.getElementById('openAddLocationModal');
            const modal = document.getElementById('addLocationModal');
            const closeModalBtn = document.querySelector('.close-modal');
            const form = document.getElementById('addLocationForm');
            const locationsContainer = document.querySelector('.locations-list');
            
            // Abrir modal
            openModalBtn.addEventListener('click', function(e) {
                e.preventDefault();
                modal.style.display = 'block';
            });
            
            // Fechar modal (X)
            closeModalBtn.addEventListener('click', function() {
                modal.style.display = 'none';
            });
            
            // Fechar modal ao clicar fora do conte√∫do
            window.addEventListener('click', function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
            
            // Adicionar local ao enviar o formul√°rio
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Verificar se o usu√°rio est√° autenticado
                const user = firebase.auth().currentUser;
                if (!user) {
                    alert('Voc√™ precisa estar logado para adicionar um local.');
                    return;
                }
                
                // Obter valores do formul√°rio
                const name = document.getElementById('locationName').value;
                const address = document.getElementById('locationAddress').value;
                const features = document.getElementById('locationFeatures').value;
                const imageUrl = document.getElementById('locationImage').value || 'https://via.placeholder.com/300x150?text=Local+Acess√≠vel';
                
                // Preparar objeto para o Firestore
                const locationData = {
                    name: name,
                    address: address,
                    features: features,
                    imageUrl: imageUrl,
                    userId: user.uid,
                    userName: user.displayName || user.email.split('@')[0],
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    rating: 0,
                    reviewCount: 0
                };
                
                // Salvar no Firestore
                firebase.firestore().collection('accessibleLocations').add(locationData)
                    .then((docRef) => {
                        // Adicionar o ID do documento aos dados
                        locationData.id = docRef.id;
                        
                        // Atualizar a UI
                        addLocationToUI(locationData);
                        
                        // Resetar o formul√°rio e fechar o modal
                        form.reset();
                        modal.style.display = 'none';
                        
                        // Mostrar mensagem de sucesso
                        alert('Local adicionado com sucesso!');
                        
                        // Atualizar contador de contribui√ß√µes do usu√°rio
                        updateUserContributionCount();
                    })
                    .catch((error) => {
                        console.error('Erro ao adicionar local:', error);
                        alert('Ocorreu um erro ao adicionar o local. Por favor, tente novamente.');
                    });
            });
            
            // Fun√ß√£o para adicionar um novo local √† interface
            function addLocationToUI(location) {
                const locationCard = document.createElement('div');
                locationCard.className = 'location-card';
                locationCard.innerHTML = `
                    <div class="location-image">
                        ${location.imageUrl.includes('placeholder') 
                            ? '<i class="fas fa-image"></i> Imagem do Local' 
                            : `<img src="${location.imageUrl}" alt="${location.name}">`}
                    </div>
                    <div class="location-details">
                        <h3>${location.name}</h3>
                        <p>${location.address}</p>
                        <p>${location.features}</p>
                        <div class="location-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="far fa-star"></i>
                            <span>Novo local (Sem avalia√ß√µes)</span>
                        </div>
                    </div>
                `;
                
                // Adicionar no in√≠cio da lista
                if (locationsContainer.firstChild) {
                    locationsContainer.insertBefore(locationCard, locationsContainer.firstChild);
                } else {
                    locationsContainer.appendChild(locationCard);
                }
            }
            
            // Fun√ß√£o para carregar locais do Firestore
            function loadLocations() {
                firebase.firestore().collection('accessibleLocations')
                    .orderBy('createdAt', 'desc')
                    .limit(6)
                    .get()
                    .then((querySnapshot) => {
                        // Limpar o container de locais
                        locationsContainer.innerHTML = '';
                        
                        // Verificar se h√° locais
                        if (querySnapshot.empty) {
                            locationsContainer.innerHTML = '<p class="no-locations">Nenhum local acess√≠vel cadastrado ainda. Seja o primeiro a contribuir!</p>';
                            return;
                        }
                        
                        // Adicionar cada local √† UI
                        querySnapshot.forEach((doc) => {
                            const locationData = doc.data();
                            locationData.id = doc.id;
                            addLocationToUI(locationData);
                        });
                    })
                    .catch((error) => {
                        console.error('Erro ao carregar locais:', error);
                        locationsContainer.innerHTML = '<p class="load-error">Erro ao carregar locais. Por favor, recarregue a p√°gina.</p>';
                    });
            }
            
            // Fun√ß√£o para atualizar o contador de contribui√ß√µes do usu√°rio
            function updateUserContributionCount() {
                const user = firebase.auth().currentUser;
                if (!user) return;
                
                firebase.firestore().collection('accessibleLocations')
                    .where('userId', '==', user.uid)
                    .get()
                    .then((querySnapshot) => {
                        const contributionCount = querySnapshot.size;
                        const contributionsElement = document.querySelector('.stat-card:nth-child(3) .stat-content p');
                        if (contributionsElement) {
                            contributionsElement.textContent = contributionCount;
                        }
                    })
                    .catch((error) => {
                        console.error('Erro ao atualizar contagem de contribui√ß√µes:', error);
                    });
            }
            
            // Inicializar: carregar locais quando o usu√°rio estiver autenticado
            firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                    loadLocations();
                    updateUserContributionCount();
                }
            });
        });
    </script>
    
    <!-- Auth state navbar handling -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get navbar elements
            const navLinks = document.querySelector('.nav-links');
            const navLinksMobile = document.querySelector('.nav-links-mobile');
            
            // Remove unnecessary links from authenticated pages
            const removeUnnecessaryLinks = () => {
                // Function to safely remove links that shouldn't be visible on authenticated pages
                const removeLink = (parentElement, hrefValue) => {
                    const links = parentElement.querySelectorAll(`a[href="${hrefValue}"]`);
                    links.forEach(link => {
                        const listItem = link.parentElement;
                        if (listItem && listItem.tagName === 'LI') {
                            listItem.remove();
                        }
                    });
                };
                
                // Remove these links as they don't make sense in an authenticated context or are handled elsewhere
                removeLink(navLinks, '#mapa');
                removeLink(navLinks, '#contribuir');
                removeLink(navLinksMobile, '#mapa');
                removeLink(navLinksMobile, '#contribuir');
            };
            
            // Clean up navbar for authenticated users
            auth.onAuthStateChanged(function(user) {
                if (user) {
                    // User is authenticated, clean up navbar
                    removeUnnecessaryLinks();
                } else {
                    // User is not authenticated, redirect to login page
                    // This is already handled in firebase-dashboard.js
                }
            });
        });
    </script>
    
    <!-- Google Maps Script (carregado dinamicamente com a API key do env-config.js) -->
    <script>
        // Fun√ß√£o para carregar a API do Google Maps com a chave das vari√°veis de ambiente
        function loadGoogleMapsScript() {
            const script = document.createElement('script');
            script.src = `https://maps.googleapis.com/maps/api/js?key=${window.ENV.GOOGLE_MAPS_API_KEY}&libraries=places&callback=initMap`;
            script.async = true;
            script.defer = true;
            document.head.appendChild(script);
        }
        
        // Aguardar o carregamento das vari√°veis de ambiente antes de carregar o Google Maps
        if (window.ENV && window.ENV.GOOGLE_MAPS_API_KEY) {
            loadGoogleMapsScript();
        } else {
            window.addEventListener('DOMContentLoaded', function() {
                if (window.ENV && window.ENV.GOOGLE_MAPS_API_KEY) {
                    loadGoogleMapsScript();
                } else {
                    console.error('Google Maps API key n√£o encontrada nas vari√°veis de ambiente');
                }
            });
        }
    </script>
</body>
</html> 